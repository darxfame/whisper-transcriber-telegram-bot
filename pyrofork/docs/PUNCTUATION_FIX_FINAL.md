# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—É–Ω–∫—Ç—É–∞—Ü–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

## üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã (CODE_REVIEW_GUIDELINES + 5 WHY)

### –°–∏–º–ø—Ç–æ–º—ã –≤ log.txt:
```
2026-02-18 07:09:40 | INFO  | ‚è≥ –ó–∞–≥—Ä—É–∂–∞—é –º–æ–¥–µ–ª—å –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏...
[Loading weights: 100%]
2026-02-18 07:10:06 | WARNING | ‚ö†Ô∏è  –û—à–∏–±–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ transformers (grouped_entities)
2026-02-18 07:10:06 | WARNING |    –ü—É–Ω–∫—Ç—É–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –∞–±–∑–∞—Ü—ã
```

**–ù–ï–¢ —Å–æ–æ–±—â–µ–Ω–∏—è:** `‚úÖ –ú–æ–¥–µ–ª—å –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞`

### –ü—Ä–∞–≤–∏–ª–æ 5 WHY:

```
1Ô∏è‚É£ –ü–æ—á–µ–º—É –ø—É–Ω–∫—Ç—É–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?
   ‚Üí PunctuationModel –ø–∞–¥–∞–µ—Ç —Å TypeError: grouped_entities

2Ô∏è‚É£ –ü–æ—á–µ–º—É –ø–∞–¥–∞–µ—Ç?
   ‚Üí transformers 4.40.2+ —É–¥–∞–ª–∏–ª–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä grouped_entities –∏–∑ pipeline API

3Ô∏è‚É£ –ü–æ—á–µ–º—É —É–¥–∞–ª–∏–ª–∞?
   ‚Üí –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ transformers –∏–∑–º–µ–Ω–∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π API –≤ –≤–µ—Ä—Å–∏–∏ 4.30+

4Ô∏è‚É£ –ü–æ—á–µ–º—É —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ deepmultilingualpunctuation?
   ‚Üí –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –¥–ª—è transformers <4.30 –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—ã–π API

5Ô∏è‚É£ –ü–æ—á–µ–º—É –Ω–µ –æ–±–Ω–æ–≤–∏–ª–∏ deepmultilingualpunctuation?
   ‚Üí –ü—Ä–æ–µ–∫—Ç –ø–ª–æ—Ö–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è (–ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç 2023)

–ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê: –í–µ—Ä—Å–∏–æ–Ω–Ω–∞—è –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫
```

## üîç –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Issue:** https://github.com/oliverguhr/deepmultilingualpunctuation/issues/79
2. **Transformers API Changes:** https://huggingface.co/docs/transformers/main_classes/pipelines
3. **–û–±—Å—É–∂–¥–µ–Ω–∏–µ –Ω–∞ HuggingFace:** https://github.com/huggingface/transformers/issues/25328

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–Ω–∏–∑–∏—Ç—å –≤–µ—Ä—Å–∏—é transformers (–í–´–ë–†–ê–ù)

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤ `requirements.txt`:**
```diff
-transformers>=4.40.2
+transformers==4.30.2
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å deepmultilingualpunctuation
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –≤–µ—Ä—Å–∏–µ–π 4.30.2
- ‚ö†Ô∏è –ú–∏–Ω—É—Å: —É—Å—Ç–∞—Ä–µ–≤—à–∞—è –≤–µ—Ä—Å–∏—è transformers

**–ò—Å—Ç–æ—á–Ω–∏–∫:** https://github.com/oliverguhr/deepmultilingualpunctuation/issues/79#issuecomment-1648392441

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fork (–ù–ï –í–´–ë–†–ê–ù)

```
deepmultilingualpunctuation-nllb @ git+https://github.com/1-800-BAD-CODE/deepmultilingualpunctuation-nllb
```

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ fork
- ‚ùå –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- ‚ùå –°–ª–æ–∂–Ω–µ–µ –æ—Ç–ª–∞–¥–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ù–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ—é –æ–±—ë—Ä—Ç–∫—É (–ù–ï –í–´–ë–†–ê–ù)

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ú–Ω–æ–≥–æ —Ä–∞–±–æ—Ç—ã
- ‚ùå –ù—É–∂–Ω–∞ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –≤ NLP
- ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

## üõ†Ô∏è –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. requirements.txt
```python
# –ë—ã–ª–æ:
transformers>=4.40.2  # ‚ùå –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞

# –°—Ç–∞–ª–æ:
transformers==4.30.2  # ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å deepmultilingualpunctuation
```

### 2. userbot.py - —É–¥–∞–ª—ë–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è –∫–æ–¥
```python
# –ë—ã–ª–æ:
except Exception as e:
    logger.error(f"‚ùå –û—à–∏–±–∫–∞: {e}")
    logger.warning("   –ü—É–Ω–∫—Ç—É–∞—Ü–∏—è –±—É–¥–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∞")
    return False
    logger.warning("   –ü—É–Ω–∫—Ç—É–∞—Ü–∏—è –±—É–¥–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∞")  # ‚ùå –î–£–ë–õ–ò–ö–ê–¢
    return False  # ‚ùå –î–£–ë–õ–ò–ö–ê–¢

# –°—Ç–∞–ª–æ:
except Exception as e:
    logger.error(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏: {e}")
    logger.warning("   –ü—É–Ω–∫—Ç—É–∞—Ü–∏—è –±—É–¥–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∞")
    return False
```

### 3. –û–±–Ω–æ–≤–ª—ë–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
```python
# –ò—Å—Ç–æ—á–Ω–∏–∫: https://github.com/oliverguhr/deepmultilingualpunctuation/issues/79
```

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ CODE_REVIEW_GUIDELINES:

- ‚úÖ **–û—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è:** –í—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
- ‚úÖ **–°–∏–Ω—Ç–∞–∫—Å–∏—Å:** `python -m py_compile userbot.py` OK
- ‚úÖ **–õ–æ–≥–∏–∫–∞:** Graceful fallback —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–ò—Å–∫–ª—é—á–µ–Ω–∏—è:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** –°—Å—ã–ª–∫–∏ –Ω–∞ GitHub issues
- ‚úÖ **5 WHY:** –ü—Ä–∏–º–µ–Ω–µ–Ω–æ, –Ω–∞–π–¥–µ–Ω–∞ –∫–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞
- ‚úÖ **–ß–µ—Å—Ç–Ω–æ—Å—Ç—å:** –£–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è transformers

## üöÄ –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

### –ù–∞ Proxmox LXC:

```bash
cd /path/to/pyrofork

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å –Ω–æ–≤—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
docker-compose down
docker-compose build --no-cache userbot
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs -f userbot

# –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
# ‚úÖ –ú–æ–¥–µ–ª—å –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
```

### –õ–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):

```bash
pip install transformers==4.30.2
python userbot.py
```

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

**–í –ª–æ–≥–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è:**
```
2026-02-18 XX:XX:XX | INFO  | ‚è≥ –ó–∞–≥—Ä—É–∂–∞—é –º–æ–¥–µ–ª—å –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏...
[Loading weights: 100%]
2026-02-18 XX:XX:XX | INFO  | ‚úÖ –ú–æ–¥–µ–ª—å –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞  # ‚Üê –í–û–¢ –≠–¢–û!
2026-02-18 XX:XX:XX | INFO  | ============================================================
2026-02-18 XX:XX:XX | INFO  | üöÄ –ó–∞–ø—É—Å–∫ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–µ—Ä–∞
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü—É–Ω–∫—Ç—É–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (restore_punctuation)
- ‚úÖ –¢–µ–∫—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏, –∑–∞–ø—è—Ç—ã–º–∏, –≤–æ–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ –†–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –∞–±–∑–∞—Ü—ã —Ä–∞–±–æ—Ç–∞–µ—Ç

## ‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ:

**transformers==4.30.2** - —ç—Ç–æ **—É—Å—Ç–∞—Ä–µ–≤—à–∞—è** –≤–µ—Ä—Å–∏—è (–∏—é–ª—å 2023).  
–ù–æ —ç—Ç–æ **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å deepmultilingualpunctuation –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–¥–∞.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –≤ –±—É–¥—É—â–µ–º:**
- –°–ª–µ–¥–∏—Ç—å –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ deepmultilingualpunctuation
- –ï—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å transformers 4.40+, –æ–±–Ω–æ–≤–∏—Ç—å requirements.txt

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | transformers 4.30.2 | transformers 4.40.2+ |
|----------|:---:|:---:|
| –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å deepmultilingualpunctuation | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |
| –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ñ–∏—á–∏ | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | ‚ö†Ô∏è –°—Ç–∞—Ä–∞—è | ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–∞—è |
| –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–æ–µ–∫—Ç–æ–º | ‚úÖ –î–∞ | ‚ùå –ù–µ—Ç |

**–í—ã–≤–æ–¥:** –ò—Å–ø–æ–ª—å–∑—É–µ–º 4.30.2 –¥–ª—è —Ä–∞–±–æ—Ç–∞—é—â–µ–π –ø—É–Ω–∫—Ç—É–∞—Ü–∏–∏.

---

**–î–∞—Ç–∞:** 2026-02-18  
**–í–µ—Ä—Å–∏—è:** 2.0.1 (hotfix - transformers compatibility)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û - –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞

