# Cursor Rules и Agents

Эта директория содержит правила и конфигурацию агентов для автоматической помощи при разработке проекта Telegram бота.

## Структура

### Правила (`.github/rules/`)

Правила автоматически применяются в зависимости от контекста работы:

- **`python-standards.mdc`** - Стандарты Python кода (всегда применяется)
- **`telegram-bot-patterns.mdc`** - Паттерны Telegram Bot API (для всех `.py` файлов)
- **`database-patterns.mdc`** - Паттерны работы с БД (для `src/database/**/*.py`)
- **`async-patterns.mdc`** - Паттерны async/await (для всех `.py` файлов)
- **`project-patterns.mdc`** - Специфичные паттерны проекта (всегда применяется)
- **`auto-agents.mdc`** - Правила автоматического применения агентов (всегда применяется)
- **`plan-first-and-expert-agents.mdc`** - При каждом запросе: анализ через эксперта агентов; сначала план в файле, потом правки в коде (для отката при разрыве связи); очистка `__pycache__` после проверки

### Агенты

#### Специализированные агенты (`.github/skills/`)

Агенты из `memory-bank/agents`, преобразованные в формат SKILL.md:

- **`code-review/`** - Комплексная проверка кода перед коммитом (ОБЯЗАТЕЛЬНО!)
- **`database-sync/`** - Синхронизация базы данных из Telegram топика
- **`database-init/`** - Умная инициализация БД с проверкой mount и репозитория
- **`railway-logging/`** - Настройка логирования для Railway.com
- **`railway-persistence/`** - Настройка персистентного хранилища Railway.com
- **`railway-env/`** - Работа с переменными окружения Railway.com

#### Общие агенты (`AGENTS.md`)

Специализированные агенты для различных задач проекта:

- **`database-agent`** - Работа с базой данных
- **`telegram-handler-agent`** - Обработчики Telegram
- **`refactoring-agent`** - Рефакторинг кода
- **`validation-agent`** - Валидация контента
- **`async-patterns-agent`** - Async/await паттерны
- **`deployment-agent`** - Подготовка к деплою

## Как это работает

1. **При каждом запросе**: анализ через эксперта агентов; изменения сначала фиксируются в файле (план), затем вносятся в код; после проверки очищаются каталоги `__pycache__` (см. `plan-first-and-expert-agents.mdc`).
2. **Правила** автоматически применяются при редактировании файлов, соответствующих их glob паттернам
3. **Агенты** автоматически применяются на основе контекста работы (см. `auto-agents.mdc`)
4. **Эксперт по применению агентов** - каждый код досконально проверяется и является полностью работоспособным
5. Вы можете явно запросить применение конкретного агента в запросе

## Эксперт по применению агентов

Я являюсь экспертом по применению агентов и автономному кодированию. Каждый выпущенный код:
- ✅ Досконально проверяется через релевантные агенты
- ✅ Является полностью работоспособным
- ✅ Следует всем паттернам проекта
- ✅ Проходит все проверки перед коммитом

## Примеры использования

### Автоматическое применение

При редактировании `src/database/database.py`:
- Автоматически применяются правила из `database-patterns.mdc`
- Автоматически применяется `database-agent`
- Проверяются SQL запросы, управление соединениями, транзакции
Автоматически при любом запросе выбирай подходящего агента и применяй.

### Явный запрос агента

```
"Примени code-review для проверки этого кода перед коммитом"
"Используй railway-logging для проверки логов"
"Примени database-sync для синхронизации БД"
```

## Обязательные проверки перед коммитом

Перед каждым коммитом ОБЯЗАТЕЛЬНО применяется агент `code-review`:
- Проверка синтаксиса Python
- Проверка соответствия паттернам проекта
- Проверка обработки ошибок
- Проверка логирования
- Проверка безопасности

## Дополнительная информация

- Подробное описание агентов: см. `AGENTS.md`
- Паттерны проекта: см. `memory-bank/systemPatterns.md`
- Технический контекст: см. `memory-bank/techContext.md`
